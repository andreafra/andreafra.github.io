---
import { getCollection } from "astro:content"
import Entry from "./Card.astro"

let allItems = await getCollection("works")

allItems = allItems
    .filter((a) => !a.data.hidden)
    .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
---

<ul class="">
    {
        allItems.map((item, index, list) => {
            const showDate =
                index > 0 &&
                list[index - 1].data.publishDate.getUTCFullYear() ==
                    item.data.publishDate.getUTCFullYear()

            return (
                <Entry
                    href={item.slug}
                    title={item.data.title}
                    date={item.data.publishDate}
                    description={item.data.description}
                    tags={item.data.tags}
                    showDate={showDate}
                />
            )
        })
    }
</ul>
